-- 구독 가능한 뉴스레터 목업 데이터 삽입
-- Supabase SQL Editor에서 실행하세요

-- 1. Newsletter 데이터 삽입
INSERT INTO newsletter (id, name, category_id, operating_status) VALUES
(80, '노마드 코더', 1, 1),
(82, '아웃스탠딩', 1, 1),
(8, 'Startup Weekly', 1, 1),
(5, '프로덕트랩', 1, 1),
(1, '미라클 레터', 1, 1),
(7, '일분톡', 1, 1),
(2, '팁스터', 1, 1),
(4, '뭐지', 1, 1)
ON CONFLICT (id) DO UPDATE 
SET 
  name = EXCLUDED.name,
  category_id = EXCLUDED.category_id,
  operating_status = EXCLUDED.operating_status;

-- 2. Mail 데이터 삽입
INSERT INTO mail (id, s3_object_key, subject, summary_list, newsletter_id, recv_at) VALUES
(4589, '41rgiievj74t5398ruensjng1jmk4l43u0hr33o1', '2025 기술 트렌드 3분 요약해드림 ?', 
 $${"플러터 스터디": "플러터 스터디에 참여하면 완주 확률이 높아지며, 10주 동안 7개의 앱 기능을 구현하며 성장할 수 있습니다. 또한, 동료들과 함께하는 커뮤니티에서 네트워킹을 통해 개발자 친구들을 만날 수 있습니다. 혼자 공부하는 것보다 함께하는 스터디가 더욱 효과적일 수 있습니다.", "2025 기술 트렌드": "6개월마다 발행되는 Radar 보고서에 따르면, AI 코딩 도구의 사용이 증가하고 있지만, AI를 완전히 신뢰하기보다는 검증 절차를 철저히 해야 합니다. Rust는 시스템 프로그래밍 언어로 주목받고 있으며, WASM은 브라우저에서 실행되는 프로그래밍 언어로 브라우저 안에서 복잡한 프로그램을 실행할 수 있는 가능성을 제공합니다. 생성형 AI 도구의 홍수로 인해 AI가 다양한 분야에서 활용되고 있습니다."}$$::jsonb,
 80, NULL),

(1910, '080lmcoaa4uuculffli2206e2fp4206juiqie681', '? 패션 커머스 시장의 치열한 2위 싸움?.. 4개사 실적을 살펴봤습니다',
 $${"에이블리의 성장과 투자 유치": "에이블리는 인플루언서 마켓을 중심으로 한 패션 커머스 플랫폼으로 거래액 1조원 이상을 기록하며 대형 플랫폼으로 성장했습니다. 2023년에는 흑자 전환에 성공하고, 2조원의 기업 가치를 목표로 투자 유치를 진행 중입니다.", "패션 커머스 시장의 치열한 2위 싸움": "패션 커머스 시장에서 무신사가 1등을 차지하고 있지만, 2위 싸움은 치열합니다. 에이블리는 흑자 전환을 이루어냈고, 카카오스타일(지그재그)은 성장세가 뚜렷하나 포지션은 애매합니다. W컨셉은 안정적이지만 답보 상태이며, 뉴넥스(구 브랜디)는 매출도 적자도 절반 수준입니다.", "오늘의집(버킷플레이스)의 성장과 전망": "오늘의집은 인테리어 정보 공유 커뮤니티에서 시작해 커머스를 도입하며 성장했습니다. 2022년 기업가치는 2조원으로 평가되었고, 2023년에는 매출 2402억원으로 증가했습니다. 완전자본잠식상태이며, 해외 시장 확장을 통해 성장과 수익성을 강화하려는 계획입니다."}$$::jsonb,
 82, NULL),

(4395, '3h25b6rgpdeopmj1395emi5puobrgq22lujja2o1', '11월 4주차 스타트업 소식 및 일정 정리',
 $${"국내 뉴스": "국내 스타트업들, 다양한 투자 유치 소식 속출", "해외 뉴스": "엔비디아, 시장 예상치 상회하는 3분기 실적 발표", "주요 행사/모임": "다가오는 주요 스타트업 행사 및 모임 안내"}$$::jsonb,
 8, NULL),

(4441, '9gdlb0c3m4rejujt0abljovpo8hooq8d6qkjm181', '? 키퍼 테스트: 성과를 내는 조직의 비밀(Netflix 사례 포함)',
 $${"성과를 내는 조직의 비밀, 키퍼 테스트에 대해 알고 계시다면 안보셔도 괜찮아요.": "넷플릭스의 성공 비결과 키퍼 테스트에 대한 내용을 다룬 인터뷰를 통해, 고밀도 인재, 솔직한 피드백, 자율과 책임, 데이터 중심 접근, 그리고 리더십의 중요성을 강조하며 넷플릭스의 성과를 이끌어낸 비밀을 소개합니다."}$$::jsonb,
 5, NULL),

(4609, 'ta7q8allbu43jrt677uq9fja73cnckdrahkvnh81', '민주주의 400년사: 주권자가 풀어야 할 숙제',
 $${"찰스 1세의 권력 투쟁": "1628년 찰스1세의 권리청원으로 시작된 권력 투쟁은 국왕과 의회 간의 갈등으로 번져나가며, 국가의 미래를 위협하는 내전의 씨앗을 심었습니다.", "민주주의 이론의 발전": "장 자크 루소를 시작으로 민주주의 이론이 발전해온 과정에서, 일반의지와 국민의 강제된 민주주의 참여에 대한 논의가 이어지고 있습니다.", "2024년 미라클 선거와 투표제도": "미라클 나라의 대통령 선거를 예시로 들어 최다득표제와 선택투표제의 한계를 설명하며, 투표제도의 문제점과 민주주의 발전에 대한 고민이 이어지고 있습니다.", "미라클 모닝을 하는 일잘러들의 참고서": "한국 역사에 획을 긋는 정치적 돌발 사태가 벌어지면서, 국제 사회에서 쌓아 올린 한국이라는 브랜드의 추락과 민주주의의 문제점, 그리고 국내 정치의 혼란에 대한 고민이 늘어나고 있습니다."}$$::jsonb,
 1, NULL),

(4610, 'j6nip3o523fps99qkvk41kuucm22m379m9kvnh81', '? 트럼프의 AI 리브랜딩',
 $${"일론 머스크의 xAI": "일론 머스크의 xAI는 창립 16개월 만에 110억 달러의 자금을 유치하며 500억 달러의 기업 가치를 기록하고 있습니다. AI 경쟁에서 빠르게 성장하고 있으며, AI 안전에 대한 의견 차이로 인해 오픈AI와의 경영권 인수 입찰이 실패한 후에도 성공을 거두고 있습니다.", "틱톡 샵 vs. 아마존": "틱톡 샵은 블랙프라이데이 하루 동안 1억 달러의 매출을 올리며 아마존에 도전하고 있습니다. 낮은 수수료와 할인 혜택으로 판매자를 유치하며, 소셜 미디어와 쇼핑이 결합된 모델로 아마존의 대안으로 자리매김하고 있습니다.", "트럼프의 AI 행정명령": "바이든 대통령의 AI 행정명령은 AI 개발과 사용에 안전성과 책임성을 강화하는 내용을 포함하고 있습니다. 트럼프는 이를 폐지하고 혁신을 강조하고 있지만, 이는 리브랜딩에 가까울 수 있습니다.", "GenCast: 고해상도 날씨 예측": "GenCast는 고해상도 예측을 통해 최대 15일 앞선 날씨 예측에서 높은 정확도를 보이며, 극단적 기상 현상에 대한 예측 능력이 뛰어나다고 합니다. 전통적인 모델보다 빠르게 예측을 생성하며, 기존 모델보다 우수한 성능을 발휘하고 있습니다."}$$::jsonb,
 7, NULL),

(4563, 'uk0urot86dr0b7et7hnprjsv4n26ms5rv1ivfi81', '? 메이커의 레시피 연말 결산, 올해의 레시피는?',
 $${"벤치마킹의 모든 것": "벤치마킹을 통해 성공적인 인사이트를 발견하는 방법과 윤리적인 고려사항을 다룹니다. 다른 기업의 성공을 모방하는 것이 아닌, 창의적이고 독창적인 해결책을 개발하는 중요성을 강조하며, 지속적인 학습과 조정이 필요한 점을 강조합니다.", "챗GPT를 활용하는 방법": "AI 서비스인 챗GPT를 기능 아이디어 발산 도구로 활용하는 방법을 다룹니다. 다양한 조건과 배경을 제시하여 기능에 대한 아이디어를 얻고, 사용자의 입장에서 평가하는 방법을 소개합니다.", "메이커의 레시피 연말 결산": "2024년 한 해, 다양한 메이커와 주제별 이야기를 다룬 '메이커의 레시피'에서 에디터들이 선정한 주제와 메이커의 코멘트를 소개합니다. 우선순위 설정의 중요성과 기준, 벤치마킹 시 윤리적 고려사항, 유저 스토리 작성 시 자주 범하는 실수, PM을 위한 가설 설정과 검증 방법, 스펙 문서의 필요성과 작성 방법 등이 다뤄지며, 다가오는 2025년을 대비하는 방안을 제시합니다.", "우선순위 설정이 중요한 이유": "우선순위 설정은 업무 효율성과 방향성 수립에 중요한 역할을 합니다. 다양한 기준을 고려하여 우선순위를 설정하고, 2025년을 대비하여 새로운 목표와 방식을 고민하는 중요성을 강조합니다.", "유저 스토리의 핵심 구성 요소": "유저 스토리 작성 시 자주 범하는 실수와 간단한 조언을 다루며, 구체적이고 명확한 유저 스토리 작성의 중요성을 강조합니다. 사용자의 행동을 정확히 파악하고, 검증 가능한 가설로 작성하는 방법을 소개합니다.", "PM을 위한 가설 설정과 검증 방법": "가설 설정 시 고려해야 할 세 가지 기준과 검증 가능성의 중요성을 강조합니다. 목표에 부합하고 검증 가능한 가설을 설정하여 데이터 기반의 의사결정을 지원하는 방법을 소개합니다.", "스펙 문서가 필요한 이유와 활용 방법": "스펙 문서의 필요성과 주요 내용, 작성 팁 및 활용 방법을 다룹니다. 팀원 간의 이해를 도모하고, 개발 가능성을 논의하며, 효율적인 업무 진행을 위한 스펙 문서의 중요성을 강조합니다."}$$::jsonb,
 2, NULL),

(4547, 'n3mj67kvcngsplkvoktlftfk638nsvkobomrv081', '(광고) 오늘의 하루를 알릴 뉴스레터가 찾아왔어요!',
 $${"날씨가 추워졌다": "이번 주에는 갑자기 날씨가 추워졌습니다.", "Open AI의 2025년 목표": "Open AI는 2025년에 'AI 에이전트 출시'를 목표로 하고 있습니다. 경쟁사들도 자체 AI 에이전트 출시를 준비 중이며, 어떤 기술이 우위를 점할지 주목됩니다.", "미국의 HBM 수출 규제에 따른 국내 영향": "미국이 중국의 AI 개발을 제한하기 위해 HBM 수출 규제를 발표했습니다. 국내 기업인 삼성전자와 SK하이닉스는 이에 대한 영향을 우려하고 있습니다.", "우아한형제들, 배민 앱 고립 위험도 자가 진단 기능 도입": "우아한형제들과 서울시가 협력하여 '외로움 없는 서울' 사업을 추진하고 있습니다. 배민 앱에 고립 위험도 자가 진단 기능을 도입하여 외로움 문제를 해결하고자 합니다."}$$::jsonb,
 4, NULL)

ON CONFLICT (id) DO UPDATE 
SET 
  s3_object_key = EXCLUDED.s3_object_key,
  subject = EXCLUDED.subject,
  summary_list = EXCLUDED.summary_list,
  newsletter_id = EXCLUDED.newsletter_id,
  recv_at = EXCLUDED.recv_at;

-- 3. Newsletter의 last_recv_at 업데이트 (최신 메일 날짜로)
UPDATE newsletter 
SET last_recv_at = (
  SELECT MAX(recv_at) 
  FROM mail 
  WHERE mail.newsletter_id = newsletter.id
)
WHERE id IN (80, 82, 8, 5, 1, 7, 2, 4);

